@page "/Index1"
@model NERA_Presentation.Pages.Index1Model
@{
    ViewData["Title"] = "NERA - EVENT CREATER";
}

<div class="create-page">
    <main class="container">
        <h1 class="page-title">Create Event</h1>
        <sl-card class="panel form-card form-shell large-centered-form larger-bg">
            <div class="accent-bar"></div>
            <form id="eventForm" class="form-grid" method="post" novalidate>
                <sl-input id="title" name="Event.Title" label="Event Title" placeholder="Enter the title" required class="full"></sl-input>

                <sl-textarea id="description" name="Event.Description" label="Description" placeholder="Describe the event" rows="5" required class="full"></sl-textarea>

                <div class="form-row">
                    <sl-input id="date" name="Event.Date" label="Date" type="date" required class="half"></sl-input>
                    <sl-select id="locationRef" name="Event.Location" label="Location (list)" placeholder="Select a venue" hoist class="half">
                        <sl-option value="">— Select —</sl-option>
                        <sl-option value="Amsterdam">Amsterdam</sl-option>
                        <sl-option value="Eindhoven">Eindhoven</sl-option>
                        <sl-option value="Online">Online</sl-option>
                        <sl-option value="other">Other…</sl-option>
                    </sl-select>
                </div>

                <div class="form-row">
                    <sl-input id="startTime" name="Event.StartTime" label="Start Time" type="time" required class="half"></sl-input>
                    <sl-input id="endTime" name="Event.EndTime" label="End Time" type="time" required class="half"></sl-input>
                </div>

                <sl-input id="locationText" label="Location (text)" placeholder="e.g. Convention Center" class="full" style="display:none"></sl-input>

                <div class="form-row">
                    <sl-input id="capacity" name="Event.Capacity" label="Max Registrations (Capacity)" type="number" min="0" class="half"></sl-input>
                    <sl-input id="cost" name="Event.Cost" label="Cost (€)" type="number" min="0" step="0.01" class="half"></sl-input>
                </div>
                <div class="form-actions full">
                    <sl-button id="clearBtn" type="button" class="btn-ghost" style="margin-right:8px">
                        <sl-icon slot="prefix" name="trash"></sl-icon>
                        Clear
                    </sl-button>
                    <sl-button type="submit" class="btn-gradient">Save</sl-button>
                    <a href="index.html" style="text-decoration:none"><sl-button class="btn-outline">Cancel</sl-button></a>
                </div>
            </form>
        </sl-card>
    </main>

    <script>
        const locationRef = document.getElementById('locationRef');
        const locationText = document.getElementById('locationText');
        const form = document.getElementById('eventForm');

        // Toggle free-text location when selecting "Other…"
        function toggleLocationText(){
          const useText = locationRef.value === 'other';
          locationText.style.display = useText ? '' : 'none';
          locationText.toggleAttribute('required', useText);
          if(useText) locationText.focus();
        }
        locationRef.addEventListener('sl-change', toggleLocationText);

        // Basic submit handler (no backend)
        form.addEventListener('submit', async (e) => {
          e.preventDefault();

          const location = locationRef.value === 'other' ? locationText.value : locationRef.value;
          const payload = {
            title: document.getElementById('title').value.trim(),
            description: document.getElementById('description').value.trim(),
            date: document.getElementById('date').value,
            startTime: document.getElementById('startTime').value,
            endTime: document.getElementById('endTime').value,
            location,
            cost: parseFloat(document.getElementById('cost').value),
            capacity: parseInt(document.getElementById('capacity').value)
          };

          console.log('Event payload', payload);
        });

        // Clear button handler to reset Shoelace fields
        document.getElementById('clearBtn').addEventListener('click', () => {
          form.reset();
          document.querySelectorAll('sl-input, sl-textarea, sl-select').forEach(el => {
            el.value = '';
          });
          toggleLocationText();
          document.getElementById('title').focus();
        });
    </script>

    <style>
    /* Center the form and increase its size */
    .large-centered-form {
        max-width: 600px !important;
        min-width: 350px;
        margin: 48px auto !important;
        padding: 40px 36px !important;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .form-grid sl-input,
    .form-grid sl-textarea,
    .form-grid sl-select {
        font-size: 1.15rem;
    }
    .form-row {
        display: flex;
        gap: 24px;
        margin-bottom: 0;
    }
    .form-row .half {
        flex: 1 1 0;
    }
    .form-grid .full {
        grid-column: 1 / -1;
    }
    .form-actions {
        justify-content: center;
    }
    .larger-bg {
        max-width: 900px !important;
        min-width: 400px;
        min-height: 520px;
        margin: 48px auto !important;
        padding: 56px 48px !important;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    </style>
</div>


